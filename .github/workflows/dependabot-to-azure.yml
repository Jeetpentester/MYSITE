name: Test Dependabot API with GitHub PAT

on:
  workflow_dispatch:

jobs:
  test-dependabot:
    runs-on: ubuntu-latest
    steps:
      - name: Test Dependabot Alerts API
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GH_SECURITY_PAT }}  # üîê Make sure this secret exists!
          script: |
            const alerts = await github.rest.dependabot.listAlertsForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'open',
              per_page: 5
            });
            console.log("Found alerts:", alerts.data.length);
            for (const alert of alerts.data) {
              console.log(`- ${alert.security_advisory.summary}`);
            }
